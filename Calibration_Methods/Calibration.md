# Calibration Methods

This folder contains work I did improving and analysing two of the three Calibration Methods used on ENGIN-X: Pin Scan and Ceria Analysis.

The Ceria_var.txt should be generated by the Ceria Analysis notebook, but in case of adversity, the file can be downloaded from here too.

On ENGIN-X, we perform three main calibrations:
- A Vanadium run at the beginning of each cycle for the Incident Beam Spectrum
- A Ceria run every collimator change for the Peak Profiles
- And a Pin Scan every few days, often before an experiment, to locate the center of the Guage Volume

**Pin Scan**

For this calibration, we take a small steel pin about a millimetre wide and take neutron measurements as we move it incrementally across the X-axis (perpendicular to the beam). Taking a sum of the intensities from each run, we can figure out the point in which the most neutrons pass through the material, and hence, the centre of the guage volume. We then repeat the process with the Y-axis, providing graphs like this:

<img width="707" height="398" alt="image" src="https://github.com/user-attachments/assets/bf1b46c5-1c5f-4226-b31a-c8b7434f6bb5" />

To begin the process, you select the range of runs in which you performed the Pin Scan, then the axis and the bank in which the data was collected - either bank one or bank two.

<img width="241" height="129" alt="PinScan_choices" src="https://github.com/user-attachments/assets/0cd875f5-1fa7-44f4-bf45-a06e7a9c17a2" />

This script was initially written with Scipy, so if you would like to select that you can alongside the fit you would like to use. If you would like a more reliable fit, however, selecting the lmfit function chooses the most suitable one for you.

After the fit has been performed, the x0 value provides you with the location where the most neutrons were counted.

**Ceria**

Whenever we change the collimators or jaws on ENGIN-X, we perform a calibration measurement of Ceria powder for the peak profile, as we know the lattice parameters of that sample and thus can adjust the time of flight measurements accordingly. I wrote a script that searches the central servers for all instances of Ceria calibration on Engin-X, then sorts them by settings and collimator, before fitting peaks to each dataset in order to compare them over time. It takes the location, height, and width of each peak then stores them all in a json for later analysis.

